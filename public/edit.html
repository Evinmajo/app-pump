<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Difference Calculator - Edit</title>
    <link rel="icon" type="image/png" href="https://img-cdn.publive.online/fit-in/1200x675/jobs-sentinalassam/media/media_files/2025/07/26/bharat-petroleum-corporation-limited-2025-07-26-15-38-59.jpg">
    <script src="./style.js"></script>
    <style>
        /* Custom styles for the Inter font and overall body */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #2563eb; /* Blue background for the entire page */
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            min-height: 100vh; /* Ensure body takes full viewport height */
            display: flex;
            justify-content: center; /* Center horizontally */
            align-items: center; /* Center vertically */
        }
        /* Ensure input type="number" does not show spin buttons */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield; /* Firefox specific */
        }
        /* Custom message box styles */
        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            text-align: center;
            font-weight: bold;
            display: none; /* Hidden by default */
        }
        .message-box.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .message-box.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .message-box button {
            margin-top: 15px;
            padding: 8px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color: #2563eb;
            color: white;
            font-weight: bold;
        }
    </style>
</head>
<body class="antialiased">
    <div class="bg-white p-6 sm:p-8 md:p-10 rounded-xl shadow-lg w-full max-w-lg md:max-w-2xl lg:max-w-4xl mx-auto my-auto">
        <h1 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-8 text-center">Edit Reading Entry</h1>

        <div id="messageBox" class="message-box">
            <p id="messageText"></p>
            <button onclick="hideMessageBox()">OK</button>
        </div>

        <form id="editForm" class="space-y-6">
            <div class="mb-8">
                <label for="currentDate" class="block text-lg font-semibold text-gray-700 mb-2 text-center">Date</label>
                <input type="date" id="currentDate" name="currentDate"
                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center font-bold">
            </div>

            <div class="mb-8">
                <label for="selectedId" class="block text-lg font-semibold text-gray-700 mb-2 text-center">ID Section</label>
                <input type="text" id="selectedId" name="selectedId"
                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center font-bold"
                       placeholder="Enter ID">
            </div>

            <div class="mb-8">
                <label for="shift" class="block text-lg font-semibold text-gray-700 mb-2 text-center">Shift</label>
                <input type="text" id="shift" name="shift"
                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center font-bold"
                       placeholder="Enter Shift value">
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 mb-8">
                <div>
                    <label for="petrol" class="block text-lg font-semibold text-gray-700 mb-2 text-center">Petrol Price</label>
                    <input type="number" id="petrol" name="petrol"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="Enter petrol price" step="0.001">
                </div>
                <div>
                    <label for="diesel" class="block text-lg font-semibold text-gray-700 mb-2 text-center">Diesel Price</label>
                    <input type="number" id="diesel" name="diesel"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="Enter diesel price" step="0.001">
                </div>
                <div>
                    <label for="oil" class="block text-lg font-semibold text-gray-700 mb-2 text-center">Oil Price</label>
                    <input type="number" id="oil" name="oil"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="Enter oil price" step="0.001">
                </div>
                <div>
                    <label for="speed" class="block text-lg font-semibold text-gray-700 mb-2 text-center">Speed Price</label>
                    <input type="number" id="speed" name="speed"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="Enter speed price" step="0.001">
                </div>
            </div>

            <hr class="my-8 border-t border-gray-300">

            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                <h2 class="text-lg sm:text-xl font-semibold text-gray-700 w-full sm:w-1/3 mb-2 sm:mb-0 text-left">Oil First Reading</h2>
                <div class="flex flex-row space-x-2 w-full sm:w-2/3 justify-end">
                    <input type="number" id="oilFirstReading" name="oilFirstReading"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                </div>
            </div>
            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                <h2 class="text-lg sm:text-xl font-semibold text-gray-700 w-full sm:w-1/3 mb-2 sm:mb-0 text-left">Oil Second Reading</h2>
                <div class="flex flex-row space-x-2 w-full sm:w-2/3 justify-end">
                    <input type="number" id="oilSecondReading" name="oilSecondReading"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                </div>
            </div>

            <hr class="my-8 border-t border-gray-300">
            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                <h2 class="text-lg sm:text-xl font-semibold text-gray-700 w-full sm:w-1/3 mb-2 sm:mb-0 text-left">Speed First Reading</h2>
                <div class="flex flex-row space-x-2 w-full sm:w-2/3 justify-end">
                    <input type="number" id="speedFirstReading1" name="speedFirstReading1" class="w-1/3 p-3 border border-gray-300 rounded-lg text-gray-800 text-center" placeholder="-" step="0.001">
                    <input type="number" id="speedFirstReading2" name="speedFirstReading2" class="w-1/3 p-3 border border-gray-300 rounded-lg text-gray-800 text-center" placeholder="-" step="0.001">
                    <input type="number" id="speedFirstReading3" name="speedFirstReading3" class="w-1/3 p-3 border border-gray-300 rounded-lg text-gray-800 text-center" placeholder="-" step="0.001">
                </div>
            </div>
            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                <h2 class="text-lg sm:text-xl font-semibold text-gray-700 w-full sm:w-1/3 mb-2 sm:mb-0 text-left">Speed Second Reading</h2>
                <div class="flex flex-row space-x-2 w-full sm:w-2/3 justify-end">
                    <input type="number" id="speedSecondReading1" name="speedSecondReading1" class="w-1/3 p-3 border border-gray-300 rounded-lg text-gray-800 text-center" placeholder="-" step="0.001">
                    <input type="number" id="speedSecondReading2" name="speedSecondReading2" class="w-1/3 p-3 border border-gray-300 rounded-lg text-gray-800 text-center" placeholder="-" step="0.001">
                    <input type="number" id="speedSecondReading3" name="speedSecondReading3" class="w-1/3 p-3 border border-gray-300 rounded-lg text-gray-800 text-center" placeholder="-" step="0.001">
                </div>
            </div>

            <hr class="my-8 border-t border-gray-300">

            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                <h2 class="text-lg sm:text-xl font-semibold text-gray-700 w-full sm:w-1/3 mb-2 sm:mb-0 text-left">Petrol First Reading</h2>
                <div class="flex flex-row space-x-2 w-full sm:w-2/3 justify-end">
                    <input type="number" id="firstReading1" name="firstReading1"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="firstReading2" name="firstReading2"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="firstReading3" name="firstReading3"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                </div>
            </div>

            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                <h2 class="text-lg sm:text-xl font-semibold text-gray-700 w-full sm:w-1/3 mb-2 sm:mb-0 text-left">Petrol Second Reading</h2>
                <div class="flex flex-row space-x-2 w-full sm:w-2/3 justify-end">
                    <input type="number" id="secondReading1" name="secondReading1"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="secondReading2" name="secondReading2"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="secondReading3" name="secondReading3"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                </div>
            </div>

            <hr class="my-8 border-t border-gray-300">

            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                <h2 class="text-lg sm:text-xl font-semibold text-gray-700 w-full sm:w-1/3 mb-2 sm:mb-0 text-left">Petrol First Reading</h2>
                <div class="flex flex-row space-x-2 w-full sm:w-2/3 justify-end">
                    <input type="number" id="firstReading4" name="firstReading1"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="firstReading5" name="firstReading2"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="firstReading6" name="firstReading3"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                </div>
            </div>

            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                <h2 class="text-lg sm:text-xl font-semibold text-gray-700 w-full sm:w-1/3 mb-2 sm:mb-0 text-left">Petrol Second Reading</h2>
                <div class="flex flex-row space-x-2 w-full sm:w-2/3 justify-end">
                    <input type="number" id="secondReading4" name="secondReading1"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="secondReading5" name="secondReading2"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="secondReading6" name="secondReading3"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                </div>
            </div>
            <hr class="my-8 border-t border-gray-300">

            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                <h2 class="text-lg sm:text-xl font-semibold text-gray-700 w-full sm:w-1/3 mb-2 sm:mb-0 text-left">Diesel First Reading</h2>
                <div class="flex flex-row space-x-2 w-full sm:w-2/3 justify-end">
                    <input type="number" id="dieselFirstReading1" name="dieselFirstReading1"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="dieselFirstReading2" name="dieselFirstReading2"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="dieselFirstReading3" name="dieselFirstReading3"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                </div>
            </div>

            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                <h2 class="text-lg sm:text-xl font-semibold text-gray-700 w-full sm:w-1/3 mb-2 sm:mb-0 text-left">Diesel Second Reading</h2>
                <div class="flex flex-row space-x-2 w-full sm:w-2/3 justify-end">
                    <input type="number" id="dieselSecondReading1" name="dieselSecondReading1"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="dieselSecondReading2" name="dieselSecondReading2"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="dieselSecondReading3" name="dieselSecondReading3"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                </div>
            </div>
            <hr class="my-8 border-t border-gray-300">

            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                <h2 class="text-lg sm:text-xl font-semibold text-gray-700 w-full sm:w-1/3 mb-2 sm:mb-0 text-left">Diesel First Reading</h2>
                <div class="flex flex-row space-x-2 w-full sm:w-2/3 justify-end">
                    <input type="number" id="dieselFirstReading4" name="dieselFirstReading1"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="dieselFirstReading5" name="dieselFirstReading2"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="dieselFirstReading6" name="dieselFirstReading3"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                </div>
            </div>

            <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6">
                <h2 class="text-lg sm:text-xl font-semibold text-gray-700 w-full sm:w-1/3 mb-2 sm:mb-0 text-left">Diesel Second Reading</h2>
                <div class="flex flex-row space-x-2 w-full sm:w-2/3 justify-end">
                    <input type="number" id="dieselSecondReading4" name="dieselSecondReading1"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="dieselSecondReading5" name="dieselSecondReading2"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                    <input type="number" id="dieselSecondReading6" name="dieselSecondReading3"
                           class="w-1/3 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="-" step="0.001">
                </div>
            </div>

            <hr class="my-8 border-t border-gray-300">

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-8">
                <div>
                    <label for="speedTestQuantity" class="block text-lg font-semibold text-gray-700 mb-2 text-center">Speed Test Quantity (Liters)</label>
                    <input type="number" id="speedTestQuantity" name="speedTestQuantity"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="Enter liters tested" step="0.001">
                </div>
                <div>
                    <label for="petrolTestQuantity" class="block text-lg font-semibold text-gray-700 mb-2 text-center">Petrol Test Quantity (Liters)</label>
                    <input type="number" id="petrolTestQuantity" name="petrolTestQuantity"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="Enter liters tested" step="0.001">
                </div>
                <div>
                    <label for="dieselTestQuantity" class="block text-lg font-semibold text-gray-700 mb-2 text-center">Diesel Test Quantity (Liters)</label>
                    <input type="number" id="dieselTestQuantity" name="dieselTestQuantity"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                           placeholder="Enter liters tested" step="0.001">
                </div>
            </div>

            <hr class="my-8 border-t border-gray-300">

            <div class="mb-6">
                <h2 class="block text-lg sm:text-xl font-semibold text-gray-700 mb-4 text-center">Packed Oil Entries</h2>
                <div id="packedOilEntriesContainer" class="space-y-3">
                    </div>
                <div class="mt-4 flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                    <input type="text" id="newPackedOilName" class="w-full sm:w-1/3 p-3 border border-gray-300 rounded-lg" placeholder="Oil Name">
                    <input type="number" id="newPackedOilAmount" class="w-full sm:w-1/3 p-3 border border-gray-300 rounded-lg" placeholder="Quantity" step="0.001">
                    <input type="number" id="newPackedOilPrice" class="w-full sm:w-1/3 p-3 border border-gray-300 rounded-lg" placeholder="Total Price" step="0.01">
                    <button type="button" onclick="addPackedOilEntry()" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-bold">Add</button>
                </div>
            </div>

            <hr class="my-8 border-t border-gray-300">

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                <div class="col-span-1">
                    <h2 class="text-lg sm:text-xl font-semibold text-gray-700 mb-4 text-center">Credit Entries</h2>
                    <div id="creditEntriesContainer" class="space-y-3">
                        </div>
                    <div class="mt-4 flex space-x-2">
                        <input type="text" id="newCreditName" class="w-1/2 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm" placeholder="Credit Name">
                        <input type="number" id="newCreditAmount" class="w-1/2 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm" placeholder="Amount" step="0.001">
                        <button type="button" onclick="addDynamicEntry('credit')" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600">Add</button>
                    </div>
                </div>

                <div class="col-span-1">
                    <h2 class="text-lg sm:text-xl font-semibold text-gray-700 mb-4 text-center">Debit Entries</h2>
                    <div id="debitEntriesContainer" class="space-y-3">
                        </div>
                    <div class="mt-4 flex space-x-2">
                        <input type="text" id="newDebitName" class="w-1/2 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm" placeholder="Debit Name">
                        <input type="number" id="newDebitAmount" class="w-1/2 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm" placeholder="Amount" step="0.001">
                        <button type="button" onclick="addDynamicEntry('debit')" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600">Add</button>
                    </div>
                </div>
            </div>

            <hr class="my-8 border-t border-gray-300">

            <div class="grid grid-cols-1 mt-8">
                <div class="col-span-1">
                    <h2 class="text-lg sm:text-xl font-semibold text-gray-700 mb-4 text-center">Expense Entries</h2>
                    <div id="expenseEntriesContainer" class="space-y-3">
                        </div>
                    <div class="mt-4 flex space-x-2">
                        <input type="text" id="newExpenseName" class="w-1/2 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm" placeholder="Expense Name">
                        <input type="number" id="newExpenseAmount" class="w-1/2 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm" placeholder="Amount" step="0.01">
                        <button type="button" onclick="addExpenseEntry()" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600">Add</button>
                    </div>
                </div>
            </div>

            <hr class="my-8 border-t border-gray-300">

            <div class="grid grid-cols-1 mt-8">
                <div class="col-span-1">
                    <h2 class="text-lg sm:text-xl font-semibold text-gray-700 mb-4 text-center">Denomination Calculator</h2>
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <label for="note500" class="w-24 text-right pr-4 text-gray-700">500 x</label>
                            <input type="number" id="note500" name="note500"
                                   class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                                   placeholder="0" min="0">
                        </div>
                        <div class="flex items-center">
                            <label for="note200" class="w-24 text-right pr-4 text-gray-700">200 x</label>
                            <input type="number" id="note200" name="note200"
                                   class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                                   placeholder="0" min="0">
                        </div>
                        <div class="flex items-center">
                            <label for="note100" class="w-24 text-right pr-4 text-gray-700">100 x</label>
                            <input type="number" id="note100" name="note100"
                                   class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                                   placeholder="0" min="0">
                        </div>
                        <div class="flex items-center">
                            <label for="note50" class="w-24 text-right pr-4 text-gray-700">50 x</label>
                            <input type="number" id="note50" name="note50"
                                   class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                                   placeholder="0" min="0">
                        </div>
                        <div class="flex items-center">
                            <label for="note20" class="w-24 text-right pr-4 text-gray-700">20 x</label>
                            <input type="number" id="note20" name="note20"
                                   class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                                   placeholder="0" min="0">
                        </div>
                        <div class="flex items-center">
                            <label for="note10" class="w-24 text-right pr-4 text-gray-700">10 x</label>
                            <input type="number" id="note10" name="note10"
                                   class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                                   placeholder="0" min="0">
                        </div>
                        <div class="flex items-center">
                            <label for="note5" class="w-24 text-right pr-4 text-gray-700">5 x</label>
                            <input type="number" id="note5" name="note5"
                                   class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                                   placeholder="0" min="0">
                        </div>
                        <div class="flex items-center">
                            <label for="coins" class="w-24 text-right pr-4 text-gray-700">Coins</label>
                            <input type="number" id="coins" name="coins"
                                   class="w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm text-gray-800 text-center"
                                   placeholder="0" step="0.01">
                        </div>
                        <div class="mb-6">
                            <label for="totalDenomination" class="block text-lg font-semibold text-gray-700 mb-2">Total Denomination Amount</label>
                            <input type="number" id="totalDenomination" name="totalDenomination" 
                                   class="w-full p-3 border border-gray-300 rounded-lg bg-gray-100 font-bold text-center" 
                                   readonly>
                        </div>
                    </div>
                </div>
            </div>

            <hr class="my-8 border-t border-gray-300">

            <div class="flex justify-center space-x-4 mt-8">
                <button type="submit"
                        class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                    Save Changes
                </button>
                <button type="button" onclick="cancelEdit()"
                        class="inline-flex items-center px-6 py-3 border border-gray-300 text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                    Cancel
                </button>
            </div>
        </form>
    </div>

    <script>
        let currentEntryId = null; // Variable to store the ID of the entry being edited

        // --- Message Box Functions ---
        function showMessageBox(message, type) {
            const messageBox = document.getElementById('messageBox');
            const messageText = document.getElementById('messageText');
            messageText.textContent = message;
            messageBox.className = `message-box ${type}`; // Add type class for styling
            messageBox.style.display = 'block';
        }

        function hideMessageBox() {
            const messageBox = document.getElementById('messageBox');
            messageBox.style.display = 'none';
        }

        // Helper function to safely get numeric value from an input
        function getNumberValue(id) {
            const element = document.getElementById(id);
            return element && !isNaN(parseFloat(element.value)) ? parseFloat(element.value) : 0;
        }

        /**
         * Dynamically adds a new packed oil entry row (name and amount) for editing.
         * Includes a remove button for the entry.
         * @param {string} name - The name of the packed oil.
         * @param {number} amount - The amount of the packed oil.
         */
         function addPackedOilEntry(name = '', amount = '', price = '') {
             const container = document.getElementById('packedOilEntriesContainer');
             const newNameInput = document.getElementById('newPackedOilName');
             const newAmountInput = document.getElementById('newPackedOilAmount');
             const newPriceInput = document.getElementById('newPackedOilPrice');
         
             if (name === '' && amount === '') {
                 name = newNameInput.value;
                 amount = newAmountInput.value;
                 price = newPriceInput.value;
                 newNameInput.value = ''; 
                 newAmountInput.value = '';
                 newPriceInput.value = '';
             }
         
             if (name.trim() === '' || amount === '') {
                 showMessageBox('Packed oil name and amount cannot be empty.', 'error');
                 return;
             }
         
             const entryDiv = document.createElement('div');
             // Added 'packed-oil-row' class for easier selection
             entryDiv.className = 'flex items-center gap-x-2 mb-3 packed-oil-row';
         
             entryDiv.innerHTML = `
                 <input type="text" value="${name}" class="w-1/3 p-3 border border-gray-300 rounded-lg packed-oil-name" placeholder="Name">
                 <input type="number" value="${amount}" class="w-1/3 p-3 border border-gray-300 rounded-lg packed-oil-amount" placeholder="Qty" step="0.001">
                 <input type="number" value="${price}" class="w-1/3 p-3 border border-gray-300 rounded-lg packed-oil-price" placeholder="Price" step="0.01">
                 <button type="button" onclick="this.parentElement.remove()" class="ml-2 px-3 py-2 bg-red-500 text-white rounded-md">X</button>
             `;
         
             container.appendChild(entryDiv);
         }

        /**
         * Dynamically adds a new credit/debit entry row (name and amount) for editing.
         * Includes a remove button for the entry.
         * @param {string} type - 'credit' or 'debit'.
         * @param {string} name - The name for the entry.
         * @param {number} amount - The amount for the entry.
         */
        function addDynamicEntry(type, name = '', amount = '') {
            const containerId = type === 'credit' ? 'creditEntriesContainer' : 'debitEntriesContainer';
            const container = document.getElementById(containerId);
            const newNameInput = document.getElementById(`new${type.charAt(0).toUpperCase() + type.slice(1)}Name`);
            const newAmountInput = document.getElementById(`new${type.charAt(0).toUpperCase() + type.slice(1)}Amount`);

            // If adding from the form, use current input values and clear them
            if (name === '' && amount === '') {
                name = newNameInput.value;
                amount = newAmountInput.value;
                newNameInput.value = ''; // Clear input fields after adding
                newAmountInput.value = '';
            }

            if (name.trim() === '' || amount === '') {
                showMessageBox(`${type.charAt(0).toUpperCase() + type.slice(1)} name and amount cannot be empty.`, 'error');
                return;
            }

            const entryDiv = document.createElement('div');
            entryDiv.className = 'flex items-center gap-x-2 mb-3';

            const nameInput = document.createElement('input');
            nameInput.type = 'text';
            nameInput.value = name;
            nameInput.className = 'w-1/2 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm dynamic-entry-name';
            nameInput.placeholder = `${type.charAt(0).toUpperCase() + type.slice(1)} Name`;

            const amountInput = document.createElement('input');
            amountInput.type = 'number';
            amountInput.value = amount;
            amountInput.className = 'w-1/2 p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-sm dynamic-entry-amount';
            amountInput.placeholder = 'Amount';
            amountInput.step = "0.001"; // Changed to 0.001 for fractional values

            const removeButton = document.createElement('button');
            removeButton.type = 'button';
            removeButton.className = 'ml-2 px-3 py-2 bg-red-500 text-white rounded-md hover:bg-red-600';
            removeButton.textContent = 'X';
            removeButton.onclick = () => {
                entryDiv.remove();
            };

            entryDiv.appendChild(nameInput);
            entryDiv.appendChild(amountInput);
            entryDiv.appendChild(removeButton);
            container.appendChild(entryDiv);
        }

        function addExpenseEntry(name = '', amount = '') {
    const container = document.getElementById('expenseEntriesContainer');
    const nameInput = document.getElementById('newExpenseName');
    const amountInput = document.getElementById('newExpenseAmount');

    if (name === '' && amount === '') {
        name = nameInput.value;
        amount = amountInput.value;
        nameInput.value = '';
        amountInput.value = '';
    }

    if (name.trim() === '' || amount === '') {
        showMessageBox('Expense name and amount cannot be empty.', 'error');
        return;
    }

    const entryDiv = document.createElement('div');
    entryDiv.className = 'flex items-center gap-x-2 mb-3 expense-row';
    entryDiv.innerHTML = `
        <input type="text" value="${name}" class="w-2/3 p-3 border border-gray-300 rounded-lg expense-name" placeholder="Expense Name">
        <input type="number" value="${amount}" class="w-1/3 p-3 border border-gray-300 rounded-lg expense-amount" placeholder="Amount">
        <button type="button" onclick="this.parentElement.remove()" class="ml-2 px-3 py-2 bg-red-500 text-white rounded-md">X</button>
    `;
    container.appendChild(entryDiv);
}

        // Function to load data from server and populate fields for editing
        async function loadDataForEdit() {
            const urlParams = new URLSearchParams(window.location.search);
            currentEntryId = urlParams.get('id'); // Get the _id from the URL

            if (currentEntryId) {
                try {
                    const response = await fetch(`/api/reading/${currentEntryId}`);
                    if (response.ok) {
                        const fetchedData = await response.json();
                        if (fetchedData) {
                            // Populate static input fields
                            document.getElementById('currentDate').value = fetchedData.currentDate || '';
                            document.getElementById('selectedId').value = fetchedData.selectedId || '';
                            document.getElementById('shift').value = fetchedData.shift || '';
                            document.getElementById('petrol').value = fetchedData.petrol || '';
                            document.getElementById('diesel').value = fetchedData.diesel || '';
                            document.getElementById('oil').value = fetchedData.oil || '';
                            document.getElementById('speed').value = fetchedData.speed || '';
                            document.getElementById('oilFirstReading').value = fetchedData.oilFirstReading || '';
                            document.getElementById('oilSecondReading').value = fetchedData.oilSecondReading || '';
                            document.getElementById('speedFirstReading1').value = fetchedData.speedFirstReading1 || '';
                            document.getElementById('speedFirstReading2').value = fetchedData.speedFirstReading2 || '';
                            document.getElementById('speedFirstReading3').value = fetchedData.speedFirstReading3 || '';
                            document.getElementById('speedSecondReading1').value = fetchedData.speedSecondReading1 || '';
                            document.getElementById('speedSecondReading2').value = fetchedData.speedSecondReading2 || '';
                            document.getElementById('speedSecondReading3').value = fetchedData.speedSecondReading3 || '';
                            document.getElementById('firstReading1').value = fetchedData.firstReading1 || '';
                            document.getElementById('firstReading2').value = fetchedData.firstReading2 || '';
                            document.getElementById('firstReading3').value = fetchedData.firstReading3 || '';
                            document.getElementById('firstReading4').value = fetchedData.firstReading4 || '';
                            document.getElementById('firstReading5').value = fetchedData.firstReading5 || '';
                            document.getElementById('firstReading6').value = fetchedData.firstReading6 || '';
                            document.getElementById('secondReading1').value = fetchedData.secondReading1 || '';
                            document.getElementById('secondReading2').value = fetchedData.secondReading2 || '';
                            document.getElementById('secondReading3').value = fetchedData.secondReading3 || '';
                            document.getElementById('secondReading4').value = fetchedData.secondReading4 || '';
                            document.getElementById('secondReading5').value = fetchedData.secondReading5 || '';
                            document.getElementById('secondReading6').value = fetchedData.secondReading6 || '';
                            document.getElementById('dieselFirstReading1').value = fetchedData.dieselFirstReading1 || '';
                            document.getElementById('dieselFirstReading2').value = fetchedData.dieselFirstReading2 || '';
                            document.getElementById('dieselFirstReading3').value = fetchedData.dieselFirstReading3 || '';
                            document.getElementById('dieselFirstReading4').value = fetchedData.dieselFirstReading4 || '';
                            document.getElementById('dieselFirstReading5').value = fetchedData.dieselFirstReading5 || '';
                            document.getElementById('dieselFirstReading6').value = fetchedData.dieselFirstReading6 || '';
                            document.getElementById('dieselSecondReading1').value = fetchedData.dieselSecondReading1 || '';
                            document.getElementById('dieselSecondReading2').value = fetchedData.dieselSecondReading2 || '';
                            document.getElementById('dieselSecondReading3').value = fetchedData.dieselSecondReading3 || '';
                            document.getElementById('dieselSecondReading4').value = fetchedData.dieselSecondReading4 || '';
                            document.getElementById('dieselSecondReading5').value = fetchedData.dieselSecondReading5 || '';
                            document.getElementById('dieselSecondReading6').value = fetchedData.dieselSecondReading6 || '';
                            document.getElementById('petrolTestQuantity').value = fetchedData.petrolTestQuantity || '';
                            document.getElementById('speedTestQuantity').value = fetchedData.speedTestQuantity || '';
                            document.getElementById('dieselTestQuantity').value = fetchedData.dieselTestQuantity || '';
                            document.getElementById('note500').value = fetchedData.note500 || '';
                            document.getElementById('note200').value = fetchedData.note200 || '';
                            document.getElementById('note100').value = fetchedData.note100 || '';
                            document.getElementById('note50').value = fetchedData.note50 || '';
                            document.getElementById('note20').value = fetchedData.note20 || '';
                            document.getElementById('note10').value = fetchedData.note10 || '';
                            document.getElementById('note5').value = fetchedData.note5 || '';
                            document.getElementById('coins').value = fetchedData.coins || '';

                            calculateTotalDenomination(); 

                            // Populate dynamic packed oil entries
                            if (fetchedData.packedOilEntries && Array.isArray(fetchedData.packedOilEntries)) {
                                fetchedData.packedOilEntries.forEach(entry => {
                                    // Added entry.price to ensure the stored price is displayed
                                    addPackedOilEntry(entry.name, entry.amount, entry.price || 0);
                                });
                            }

                            // Populate dynamic credit entries
                            if (fetchedData.creditEntries && Array.isArray(fetchedData.creditEntries)) {
                                fetchedData.creditEntries.forEach(entry => {
                                    addDynamicEntry('credit', entry.name, entry.amount);
                                });
                            }
                            if (fetchedData.expenseEntries && Array.isArray(fetchedData.expenseEntries)) {
                                const container = document.getElementById('expenseEntriesContainer');
                                container.innerHTML = ''; // Clear existing
                                fetchedData.expenseEntries.forEach(entry => {
                                    addExpenseEntry(entry.name, entry.amount);
                                });
                            }

                            // Populate dynamic debit entries
                            if (fetchedData.debitEntries && Array.isArray(fetchedData.debitEntries)) {
                                fetchedData.debitEntries.forEach(entry => {
                                    addDynamicEntry('debit', entry.name, entry.amount);
                                });
                            }

                        } else {
                            showMessageBox('No data found for this ID.', 'error');
                            console.log('No data found for ID:', currentEntryId);
                        }
                    } else {
                        showMessageBox('Failed to fetch data from the server.', 'error');
                        console.error('Server error:', response.statusText);
                    }
                } catch (error) {
                    console.error('Error fetching data:', error);
                    showMessageBox('An error occurred while fetching data.', 'error');
                }
            } else {
                showMessageBox('No entry ID provided in the URL.', 'error');
                console.log('No entry ID provided in the URL for edit.html');
            }
        }

        // Function to calculate total denomination
function calculateTotalDenomination() {
    const denominations = {
        'note500': 500, 'note200': 200, 'note100': 100, 
        'note50': 50, 'note20': 20, 'note10': 10, 
        'note5': 5, 'coins': 1
    };

    let total = 0;
    for (const [id, value] of Object.entries(denominations)) {
        const count = parseFloat(document.getElementById(id)?.value) || 0;
        total += count * value;
    }
    document.getElementById('totalDenomination').value = total;
}

// Add event listeners to all denomination inputs
document.addEventListener('DOMContentLoaded', () => {
    const fields = ['note500', 'note200', 'note100', 'note50', 'note20', 'note10', 'note5', 'coins'];
    fields.forEach(id => {
        document.getElementById(id)?.addEventListener('input', calculateTotalDenomination);
    });
});
        // Function to handle saving changes
        async function saveChanges(event) {
            event.preventDefault(); // Prevent default form submission

            const data = {
                currentDate: document.getElementById('currentDate').value,
                selectedId: document.getElementById('selectedId').value,
                shift: getNumberValue('shift'),
                petrol: getNumberValue('petrol'),
                diesel: getNumberValue('diesel'),
                oil: getNumberValue('oil'),
                speed: getNumberValue('speed'),
                oilFirstReading: getNumberValue('oilFirstReading'),
                oilSecondReading: getNumberValue('oilSecondReading'),
                speedFirstReading1:  getNumberValue('speedFirstReading1'),
                speedFirstReading2:  getNumberValue('speedFirstReading2'),
                speedFirstReading3:  getNumberValue('speedFirstReading3'),
                speedSecondReading1:  getNumberValue('speedSecondReading1'),
                speedSecondReading2:  getNumberValue('speedSecondReading2'),
                speedSecondReading3:  getNumberValue('speedSecondReading3'),
                firstReading1: getNumberValue('firstReading1'),
                firstReading2: getNumberValue('firstReading2'),
                firstReading3: getNumberValue('firstReading3'),
                firstReading4: getNumberValue('firstReading4'),
                firstReading5: getNumberValue('firstReading5'),
                firstReading6: getNumberValue('firstReading6'),
                secondReading1: getNumberValue('secondReading1'),
                secondReading2: getNumberValue('secondReading2'),
                secondReading3: getNumberValue('secondReading3'),
                secondReading4: getNumberValue('secondReading4'),
                secondReading5: getNumberValue('secondReading5'),
                secondReading6: getNumberValue('secondReading6'),
                
                dieselFirstReading1: getNumberValue('dieselFirstReading1'),
                dieselFirstReading2: getNumberValue('dieselFirstReading2'),
                dieselFirstReading3: getNumberValue('dieselFirstReading3'),
                dieselFirstReading4: getNumberValue('dieselFirstReading4'),
                dieselFirstReading5: getNumberValue('dieselFirstReading5'),
                dieselFirstReading6: getNumberValue('dieselFirstReading6'),
                dieselSecondReading1: getNumberValue('dieselSecondReading1'),
                dieselSecondReading2: getNumberValue('dieselSecondReading2'),
                dieselSecondReading3: getNumberValue('dieselSecondReading3'),
                dieselSecondReading4: getNumberValue('dieselSecondReading4'),
                dieselSecondReading5: getNumberValue('dieselSecondReading5'),
                dieselSecondReading6: getNumberValue('dieselSecondReading6'),
                speedTestQuantity: getNumberValue('speedTestQuantity'),
                petrolTestQuantity: getNumberValue('petrolTestQuantity'),
                dieselTestQuantity: getNumberValue('dieselTestQuantity'),
                totalDenomination: getNumberValue('totalDenomination'),
                note500: getNumberValue('note500'),
                note200: getNumberValue('note200'),
                note100: getNumberValue('note100'),
                note50: getNumberValue('note50'),
                note20: getNumberValue('note20'),
                note10: getNumberValue('note10'),
                note5: getNumberValue('note5'),
                coins: getNumberValue('coins'),
            };
           
            // Add this helper inside your saveChanges function to extract entries
           // Correctly collect Packed Oil Entries
           data.packedOilEntries = [];
           document.querySelectorAll('.packed-oil-row').forEach(row => {
               const name = row.querySelector('.packed-oil-name').value;
               const amount = parseFloat(row.querySelector('.packed-oil-amount').value) || 0;
               const price = parseFloat(row.querySelector('.packed-oil-price').value) || 0;
               
               if (name.trim() !== "") {
                   data.packedOilEntries.push({ name, amount, price });
               }
           });

            // Collect dynamic credit entries
            data.creditEntries = [];
            document.querySelectorAll('#creditEntriesContainer > div').forEach(entryDiv => {
                const nameInput = entryDiv.querySelector('.dynamic-entry-name');
                const amountInput = entryDiv.querySelector('.dynamic-entry-amount');
                if (nameInput && amountInput) {
                    data.creditEntries.push({
                        name: nameInput.value,
                        amount: parseFloat(amountInput.value) || 0
                    });
                }
            });

            // Collect Expenses
            data.expenseEntries = [];
            document.querySelectorAll('.expense-row').forEach(row => {
                const name = row.querySelector('.expense-name').value;
                const amount = parseFloat(row.querySelector('.expense-amount').value) || 0;
                if (name.trim() !== "") {
                    data.expenseEntries.push({ name, amount });
                }
            });

            // Collect dynamic debit entries
            data.debitEntries = [];
            document.querySelectorAll('#debitEntriesContainer > div').forEach(entryDiv => {
                const nameInput = entryDiv.querySelector('.dynamic-entry-name');
                const amountInput = entryDiv.querySelector('.dynamic-entry-amount');
                if (nameInput && amountInput) {
                    data.debitEntries.push({
                        name: nameInput.value,
                        amount: parseFloat(amountInput.value) || 0
                    });
                }
            });

            try {
                const response = await fetch(`/api/reading/${currentEntryId}`, {
                    method: 'PUT', // Use PUT for updating an existing resource
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    showMessageBox('Entry updated successfully!', 'success');
                    // Redirect back to view.html after a short delay
                    setTimeout(() => {
                        window.location.href = `view.html?id=${currentEntryId}`;
                    }, 1500);
                } else {
                    showMessageBox('Failed to update entry. Please try again.', 'error');
                    console.error('Server error:', response.statusText);
                }
            } catch (error) {
                console.error('Error updating entry:', error);
                showMessageBox('An error occurred while updating the entry.', 'error');
            }
        }

        // Function to handle cancel action
        function cancelEdit() {
            if (currentEntryId) {
                window.location.href = `view.html?id=${currentEntryId}`;
            } else {
                window.location.href = `admin.html`; // Fallback if no ID is found (e.g., direct access to edit.html)
            }
        }

        // Event listener for form submission
        document.addEventListener('DOMContentLoaded', () => {
            loadDataForEdit();
            document.getElementById('editForm').addEventListener('submit', saveChanges);
        });
    </script>
</body>
</html>
